{% extends 'bootest.html'%}
{% load static %}

{% block title %} MAIN {% endblock %}
{% block styles %}


.timer {
    width: 200px;
    height: 200px;
    border-radius: 50%;
    background: conic-gradient(
        red 0% 0%, 
        green 100% 100%
    );
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 20px;
transform: translateX(25%);

    }



{% endblock %}
{% block headparam %}
<script src="{% static 'JS/generate.js' %}"></script>
{% endblock %}


{% block content %} 
<script>
function opercurse(id,text){
    localStorage.setItem('id_buff',id);

    $("#cur").text(text);
}
</script>


<div class="container">
<div>
    <h3 class="text-center" id="dateOutput"></h1>
    <h1 class = "text-center" id="solarTermOutput"></h1>
</div>
    
    <div id="inspirationDiv" class="text-center bg-secondary text-white ">
    </div>

    <div class="p-2">
        <div class="form-floating">
            <div class="input-group">
                <span class="input-group-text bg-info bg-gradient text-light" id="LogIN">事件</span>
                <div class="form-floating bg-warning bg-gradient">
                    <textarea id = "Logwhat" class="form-control bg-warning  " placeholder="Leave a comment here" id="floatingTextarea" ></textarea>
                    <label class="h2 text-muted" for="floatingTextarea">LOGing...</label>
                </div>
            </div>
        </div>
    </div>
    

 
        <div class='container'>

<div class="p-2 gap-2 d-block">
  <!---
   <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#eventModal">事件</button>
  <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#thinkModal">空想</button>
  ---!>
  <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#noteModal">記事</button>


</div>

    </div>



</div>

<div class="container">
    <div class ="row justify-content-center p-2">
        <div class="card" style="width: 18rem;">
            <div class="card-body">
                <ul class="list-group list-group-flush">
                    {% for curse in curses %}
                    <li class="list-group-item"  onclick="opercurse('{{curse.id}}','{{curse.content}}' )" 
            data-bs-toggle="modal" data-bs-target="#curseModal">
                    <span class="badge bg-warning">咒</span>{{curse.content}}</li>
                    {% endfor %}
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                    <li class="list-group-item"> </li>
                </ul>
            </div>
        </div>
    </div>
</div>


<!---- modal --->
<div class="modal fade" id="curseModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
      <div class="modal-content ">
      <div class="modal-body text-center ">
        <!-- 按鈕和標籤 -->
        <button type="button" id="curseFinish" class="btn btn-success" data-bs-dismiss="modal"data-bs-toggle="modal" data-bs-target="#timeModal">除咒</button>
       <span id="cur"></span>
         <button type="button" id="curseBack" class="btn btn-warning" data-bs-dismiss="modal"data-bs-toggle="modal" data-bs-target="#timeModal">退</button>
      </div>
    </div>
  </div>
</div>









<!-- Modal -->
<div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-footer">
                <div class="input-group ">
                    <input type="text" class="form-control border-0" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="button-addon2" id="eventWhat">
                    <button class="btn btn-outline-secondary border-0" type="button"  data-bs-dismiss="modal" id="eveIn">加入</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="thinkModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-footer">
                <div class="input-group ">
                    <input type="text" class="form-control border-0" placeholder="Recipient's username" aria-label="Recipient's username" aria-describedby="button-addon2" id="thinkWhat">
                    <button class="btn btn-outline-secondary border-0" type="button" id="thinkIn">加入</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="noteModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
      <div class="modal-header border-0">
     <div class="input-group border-0 ">
  <span class="input-group-text  border-0 " id="basic-addon1">題</span>
  <input type="text" class="form-control  border-0 " placeholder="....." aria-label="Username" aria-describedby="basic-addon1" id="noteTitle">
</div>
      </div>
            <div class="modal-body ">
                <textarea class="form-control border-0" id="notes" rows="3"></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal" id="noteIn">IN</button>
            </div>
        </div>
    </div>
</div>


{% endblock %}

{% block scripts %}

$("#LogIN").click(function(){
  
    var what = $("#Logwhat").val();
    what = '#' + what ;
    $("#Logwhat").val('');
    var Data = {'talks':what};
    $.ajax({
	type:'POST',
	url:'/talking/',
    dataType:'json',
	data:Data,
	success:function(response){
    },
	error:function(response){}

	});


});

$("#eveIn").click(function(){
    var what = $("#eventWhat").val();
    $("#eventWhat").val('');
    what = '#' + what;
    var Data = {'talks':what};
    $.ajax({
	type:'POST',
	url:'/talking/',
    dataType:'json',
	data:Data,
	success:function(response){
    },
	error:function(response){}

	});

 });

$("#thinkIn").click(function(){

    var what = $("#thinkWhat").val();
    $("#thinkWhat").val('');
    what = '@' + what;
    var Data = {'talks':what};
    $.ajax({
        type:'POST',
        url:'/talking/',
        dataType:'json',
        data:Data,


    });
});


$("#noteIn").click(function(){
    var title = $("#noteTitle").val();
    if (title == ''){
        alert('題 不能空白！');
    }else
    {
        $("#noteTitle").val('');
        var notes = $("#notes").val();
        $("#notes").val('');
        var Data = {'talks':"newNote",'title':title,'note':notes};
    $.ajax({
        type:'POST',
        url:'/talking/',
        dataType:'json',
        data:Data,
        

    });

    }



});

displayInspiration();

function getCurrentDate() {
    const today = new Date();
    return today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();
}

function getSolarTerm(date) {
    const terms = [
        "小寒", "大寒", "立春", "雨水", "驚蟄", "春分",
        "清明", "穀雨", "立夏", "小滿", "芒種", "夏至",
        "小暑", "大暑", "立秋", "處暑", "白露", "秋分",
        "寒露", "霜降", "立冬", "小雪", "大雪", "冬至"
    ];
    const termDates = [
        // Dates are approximate and might need adjustments
        new Date(date.getFullYear(), 0, 5), new Date(date.getFullYear(), 0, 20),
        // ... [dates for other solar terms] ...
        new Date(date.getFullYear(), 11, 22), new Date(date.getFullYear(), 11, 31)
    ];
    



    for (let i = 0; i < termDates.length; i++) {
        if (date < termDates[i]) {
            return terms[i];
        }
    }
    return terms[0];
}










function updateDateAndSolarTerm() {
    const currentDate = new Date();
    const dateStr = getCurrentDate();
    const solarTerm = getSolarTerm(currentDate);

    document.getElementById('dateOutput').textContent = '' + dateStr;
    document.getElementById('solarTermOutput').textContent = '' + solarTerm;
}

updateDateAndSolarTerm();


$("#curseFinish").click(function(){
    var id = localStorage.getItem("id_buff");
    var curname = $("#cur").text();
    curname = "✔"+curname; 
    const Data = {'id':id,'talks':curname};
    $.ajax({
	type:'POST',
	url:'/talking/',
    dataType:'json',
	data:Data,
	success:function(response){
    navigator.vibrate(1000); // 1 秒振動
        alert(response.response);
        location.reload();
    },
	error:function(response){}
	});
 
});

$("#curseBack").click(function(){
    var id = localStorage.getItem("id_buff");
    var curname = $("#cur").text();
    curname = "}"+curname; 
    const Data = {'id':id,'talks':curname};
    $.ajax({
	type:'POST',
	url:'/talking/',
    dataType:'json',
	data:Data,
	success:function(response){
        alert(response.response);
        location.reload();
    },
	error:function(response){}
	});
 


});
function talksTo(param)
{

console.log(param);
}


{% endblock %}
 

